<?php

namespace Ezypay\Resource;
use Ezypay\Object\ObjectFactory;

/**
 * Class Customer
 * @package Ezypay\Resource
 */
class Customer extends Resurce implements \resourceInterfaceCustomer , \resourceInterfaceCreate , \resourceInterfaceUpdate
{
    /**
     * @var string defautl object name
     */
    private $objectType = 'Customer';

    public function __construct( \driverInterface $connector)
    {

        parent::__construct($connector,$this->objectType);
    }

    /**
     * Get the list of customers. You can further filter the list of customer that relates to the individual merchant using merchantId.
     *
     * @link https://demoapi.ezypay.com/help/docs#!/Customers/CustomersApi_GetCustomerList
     * @param array $data EzyPay API parametes (see link)
     * @return \resultInterfaceList | \resultInterfaceError
     */
    public function findAll(array $data=array())
    {
       $this->settings(array(
           'url'    => !empty($data)?'customers?'.http_build_query($data):'customers',
           'method' => 'GET'
       ));

        return $this->result();
    }

    /**
     * Retrieve the details of an existing customer.
     *
     * @link https://demoapi.ezypay.com/help/docs#!/Customers/CustomersApi_GetCustomerById
     * @param $id string EzyPay customer ID
     * @return \result | \resultInterfaceError
     */
    public function findById($id){

        $this->settings(array(
            'url' => 'customers/' .  $id,
            'method' => 'GET'
        ));
        return $this->result();
    }

    /**
     * Retrieve the details of an existing customer using referenceId.
     *
     * @link https://demoapi.ezypay.com/help/docs#!/Customers/CustomersApi_GetCustomerByReferenceId
     * @param $id string The reference ID of the customer. A unique identifier from a third-party software integration.
     * @return \Ezypay\Object\Customer
     */
    public function findByReferenceId($id)
    {
        $this->settings(array(
            'url' => 'customers/reference/' . $id ,
            'method' => 'GET'
        ));
        return $this->result();
    }

    /**
     * Add the customer along with optional details such as address, payment method, and subscriptions which you can provide later on
     *
     * @link https://demoapi.ezypay.com/help/docs#!/Customers/CustomersApi_CreateCustomer
     * @param array $data The customer data. Refer to request body schema (see link)
     * @return \result | \resultInterfaceError
     */
    public function create(array $data)
    {

        $this->settings(array(
            'url'=> 'customers',
            'method' => 'POST',
            'data'=> $data
        ));
        return $this->result();
    }

    /**
     * Update an existing customer details.
     *
     * @link https://demoapi.ezypay.com/help/docs#!/Customers/CustomersApi_UpdateCustomer
     * @param $id sting The ID of the customer. A unique identifier generated by the system
     * @param array $data The customer data. Refer to request body schema (see link)
     * @return \result | \resultInterfaceError
     */
    public function update($id,array $data)
    {
        $this->settings(array(
            'url' => 'customers/' . $id ,
            'method' => 'PUT',
            'data' => $data
        ));

        return $this->result();
    }

}
